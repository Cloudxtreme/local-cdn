#!/usr/bin/env node

// Usage: serve <config-file> [port] [--compress]

var connect = require('connect');
var cdn = require('../index');

var args = process.argv;

if (args.length < 3) {
    console.log("Usage: serve <config-file> [port] [--compress]");
}

var configFilePath = args[2];
var port = args[3] || 8000;

var config = cdn.config.fromFileSync(configFilePath);

var server = connect.createServer(
    connect.logger({ format: ':method :url :response-time => :status'}),
    cdn.serve(config),
    connect.staticProvider(config.staticDir)
);

server.listen(port);

console.log("Server started on http://localhost:8000/ ...");
